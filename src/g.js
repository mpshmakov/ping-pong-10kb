(()=>{var t,i,e=()=>{};function s(t,i){let e=i.parentNode;if(t.setAttribute("data-kontra",""),e){let s=e.querySelector("[data-kontra]:last-of-type")||i;e.insertBefore(t,s.nextSibling)}else document.body.appendChild(t)}function h(t,i){let e=t.indexOf(i);if(-1!=e)return t.splice(e,1),!0}var n={};function r(t,i){n[t]=n[t]||[],n[t].push(i)}function o(t,...i){(n[t]||[]).map((t=>t(...i)))}var a={get:(t,i)=>"_proxy"==i||e};function c(){return i}function d(t,i,e){return Math.min(Math.max(t,e),i)}function l(t,i){return[t,i]=[t,i].map((t=>function(t){let{x:i=0,y:e=0,width:s,height:h}=t.world||t;return t.mapwidth&&(s=t.mapwidth,h=t.mapheight),t.anchor&&(i-=s*t.anchor.x,e-=h*t.anchor.y),s<0&&(i+=s,s*=-1),h<0&&(e+=h,h*=-1),{x:i,y:e,width:s,height:h}}(t))),t.x<i.x+i.width&&t.x+t.width>i.x&&t.y<i.y+i.height&&t.y+t.height>i.y}var u=class{constructor(t=0,i=0,e={}){null!=t.x?(this.x=t.x,this.y=t.y):(this.x=t,this.y=i),e._c&&(this.clamp(e._a,e._b,e._d,e._e),this.x=t,this.y=i)}set(t){this.x=t.x,this.y=t.y}add(t){return new u(this.x+t.x,this.y+t.y,this)}subtract(t){return new u(this.x-t.x,this.y-t.y,this)}scale(t){return new u(this.x*t,this.y*t)}normalize(t=this.length()||1){return new u(this.x/t,this.y/t)}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.hypot(this.x,this.y)}distance(t){return Math.hypot(this.x-t.x,this.y-t.y)}angle(t){return Math.acos(this.dot(t)/(this.length()*t.length()))}direction(){return Math.atan2(this.y,this.x)}clamp(t,i,e,s){this._c=!0,this._a=t,this._b=i,this._d=e,this._e=s}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?d(this._a,this._d,t):t}set y(t){this._y=this._c?d(this._b,this._e,t):t}};function y(){return new u(...arguments)}var _=class{constructor(t){return this.init(t)}init(t={}){this.position=y(),this.velocity=y(),this.acceleration=y(),this.ttl=1/0,Object.assign(this,t)}update(t){this.advance(t)}advance(t){let i=this.acceleration;t&&(i=i.scale(t)),this.velocity=this.velocity.add(i);let e=this.velocity;t&&(e=e.scale(t)),this.position=this.position.add(e),this._pc(),this.ttl--}get dx(){return this.velocity.x}get dy(){return this.velocity.y}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}isAlive(){return this.ttl>0}_pc(){}},x=class extends _{init({width:t=0,height:i=0,context:e=c(),render:s=this.draw,update:h=this.advance,children:n=[],anchor:o={x:0,y:0},opacity:a=1,rotation:d=0,scaleX:l=1,scaleY:u=1,...y}={}){this._c=[],super.init({width:t,height:i,context:e,anchor:o,opacity:a,rotation:d,scaleX:l,scaleY:u,...y}),this._di=!0,this._uw(),this.addChild(n),this._rf=s,this._uf=h,r("init",(()=>{this.context??=c()}))}update(t){this._uf(t),this.children.map((i=>i.update&&i.update(t)))}render(){let t=this.context;t.save(),(this.x||this.y)&&t.translate(this.x,this.y),this.rotation&&t.rotate(this.rotation),1==this.scaleX&&1==this.scaleY||t.scale(this.scaleX,this.scaleY);let i=-this.width*this.anchor.x,e=-this.height*this.anchor.y;(i||e)&&t.translate(i,e),this.context.globalAlpha=this.opacity,this._rf(),(i||e)&&t.translate(-i,-e),this.children.map((t=>t.render&&t.render())),t.restore()}draw(){}_pc(){this._uw(),this.children.map((t=>t._pc()))}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this._pc()}set y(t){this.position.y=t,this._pc()}get width(){return this._w}set width(t){this._w=t,this._pc()}get height(){return this._h}set height(t){this._h=t,this._pc()}_uw(){if(!this._di)return;let{_wx:t=0,_wy:i=0,_wo:e=1,_wr:s=0,_wsx:h=1,_wsy:n=1}=this.parent||{};this._wx=this.x,this._wy=this.y,this._ww=this.width,this._wh=this.height,this._wo=e*this.opacity,this._wsx=h*this.scaleX,this._wsy=n*this.scaleY,this._wx=this._wx*h,this._wy=this._wy*n,this._ww=this.width*this._wsx,this._wh=this.height*this._wsy,this._wr=s+this.rotation;let{x:r,y:o}=function(t,i){let e=Math.sin(i),s=Math.cos(i);return{x:t.x*s-t.y*e,y:t.x*e+t.y*s}}({x:this._wx,y:this._wy},s);this._wx=r,this._wy=o,this._wx+=t,this._wy+=i}get world(){return{x:this._wx,y:this._wy,width:this._ww,height:this._wh,opacity:this._wo,rotation:this._wr,scaleX:this._wsx,scaleY:this._wsy}}set children(t){this.removeChild(this._c),this.addChild(t)}get children(){return this._c}addChild(...t){t.flat().map((t=>{this.children.push(t),t.parent=this,t._pc=t._pc||e,t._pc()}))}removeChild(...t){t.flat().map((t=>{h(this.children,t)&&(t.parent=null,t._pc())}))}get opacity(){return this._opa}set opacity(t){this._opa=d(0,1,t),this._pc()}get rotation(){return this._rot}set rotation(t){this._rot=t,this._pc()}setScale(t,i=t){this.scaleX=t,this.scaleY=i}get scaleX(){return this._scx}set scaleX(t){this._scx=t,this._pc()}get scaleY(){return this._scy}set scaleY(t){this._scy=t,this._pc()}},w=class extends x{init({image:t,width:i=(t?t.width:void 0),height:e=(t?t.height:void 0),...s}={}){super.init({image:t,width:i,height:e,...s})}get animations(){return this._a}set animations(t){let i,e;for(i in this._a={},t)this._a[i]=t[i].clone(),e=e||this._a[i];this.currentAnimation=e,this.width=this.width||e.width,this.height=this.height||e.height}playAnimation(t){this.currentAnimation?.stop(),this.currentAnimation=this.animations[t],this.currentAnimation.start()}advance(t){super.advance(t),this.currentAnimation?.update(t)}draw(){this.image&&this.context.drawImage(this.image,0,0,this.image.width,this.image.height),this.currentAnimation&&this.currentAnimation.render({x:0,y:0,width:this.width,height:this.height,context:this.context}),this.color&&(this.context.fillStyle=this.color,this.context.fillRect(0,0,this.width,this.height))}};function p(){return new w(...arguments)}function g(t){let i=t.canvas;t.clearRect(0,0,i.width,i.height)}function m({fps:t=60,clearCanvas:i=!0,update:s=e,render:h,context:n=c(),blur:a=!1}={}){if(!h)throw Error("You must provide a render() function");let d,l,u,y,_,x=0,w=1e3/t,p=1/t,m=i?g:e,f=!0;function v(){if(l=requestAnimationFrame(v),f&&(u=performance.now(),y=u-d,d=u,!(y>1e3))){for(o("tick"),x+=y;x>=w;)_.update(p),x-=w;m(_.context),_.render()}}return a||(window.addEventListener("focus",(()=>{f=!0})),window.addEventListener("blur",(()=>{f=!1}))),r("init",(()=>{_.context??=c()})),_={update:s,render:h,isStopped:!0,context:n,start(){d=performance.now(),this.isStopped=!1,requestAnimationFrame(v)},stop(){this.isStopped=!0,cancelAnimationFrame(l)},_frame:v,set _last(t){d=t}},_}var f={},v={},b={},A={Enter:"enter",Escape:"esc",Space:"space",ArrowLeft:"arrowleft",ArrowUp:"arrowup",ArrowRight:"arrowright",ArrowDown:"arrowdown"};function C(t=e,i){t._pd&&i.preventDefault(),t(i)}function S(t){let i=A[t.code],e=f[i];b[i]=!0,C(e,t)}function Y(t){let i=A[t.code],e=v[i];b[i]=!1,C(e,t)}function E(){b={}}function X(t){return!![].concat(t).some((t=>b[t]))}function j(t){let i=[];return t._dn?i.push(t._dn):t.children&&t.children.map((t=>{i=i.concat(j(t))})),i}var F=class{constructor({id:t,name:i=t,objects:e=[],context:h=c(),cullObjects:n=!0,cullFunction:o=l,sortFunction:a,...d}){this._o=[],Object.assign(this,{id:t,name:i,context:h,cullObjects:n,cullFunction:o,sortFunction:a,...d});let u=this._dn=document.createElement("section");u.tabIndex=-1,u.style="position:absolute;width:1px;height:1px;overflow:hidden;clip:rect(0,0,0,0);",u.id=t,u.setAttribute("aria-label",i);let y=this;this.camera=new class extends x{set x(t){y.sx=t-this.centerX,super.x=t}get x(){return super.x}set y(t){y.sy=t-this.centerY,super.y=t}get y(){return super.y}}({context:h,anchor:{x:.5,y:.5},render:this._rf.bind(this)}),this.add(e),this._i=()=>{this.context??=c();let t=this.context.canvas,{width:i,height:e}=t,h=i/2,n=e/2;Object.assign(this.camera,{centerX:h,centerY:n,x:h,y:n,width:i,height:e}),this._dn.isConnected||s(this._dn,t)},this.context&&this._i(),r("init",this._i)}set objects(t){this.remove(this._o),this.add(t)}get objects(){return this._o}add(...t){t.flat().map((t=>{this._o.push(t),t.parent=this,j(t).map((t=>{this._dn.appendChild(t)}))}))}remove(...t){t.flat().map((t=>{h(this._o,t),t.parent=null,j(t).map((t=>{s(t,this.context)}))}))}show(){this.hidden=this._dn.hidden=!1;let t=this._o.find((t=>t.focus));t?t.focus():this._dn.focus(),this.onShow()}hide(){this.hidden=this._dn.hidden=!0,this.onHide()}destroy(){var t,i;t="init",i=this._i,n[t]=(n[t]||[]).filter((t=>t!=i)),this._dn.remove(),this._o.map((t=>t.destroy&&t.destroy()))}lookAt(t){let{x:i,y:e}=t.world||t;this.camera.x=i,this.camera.y=e}update(t){this.hidden||this._o.map((i=>i.update&&i.update(t)))}_rf(){let{_o:t,context:i,_sx:e,_sy:s,camera:h,sortFunction:n,cullObjects:r,cullFunction:o}=this;i.translate(e,s);let a=t;r&&(a=a.filter((t=>o(h,t)))),n&&a.sort(n),a.map((t=>t.render&&t.render()))}render(){if(!this.hidden){let{context:t,camera:i}=this,{x:e,y:s,centerX:h,centerY:n}=i;t.save(),this._sx=h-e,this._sy=n-s,t.translate(this._sx,this._sy),i.render(),t.restore()}}onShow(){}onHide(){}};var{canvas:k,context:M}=function(e,{contextless:s=!1}={}){if(t=document.getElementById(e)||e||document.querySelector("canvas"),s&&(t=t||new Proxy({},a)),!t)throw Error("You must provide a canvas element for the game");return(i=t.getContext("2d")||new Proxy({},a)).imageSmoothingEnabled=!1,o("init"),{canvas:t,context:i}}();!function(){let t;for(t=0;t<26;t++)A["Key"+String.fromCharCode(t+65)]=String.fromCharCode(t+97);for(t=0;t<10;t++)A["Digit"+t]=A["Numpad"+t]=""+t;window.addEventListener("keydown",S),window.addEventListener("keyup",Y),window.addEventListener("blur",E)}();var O=2.5,L=p({anchor:{x:.5,y:.5},width:26,height:110,x:13,y:256,color:"white"}),q=p({anchor:{x:.5,y:.5},width:26,height:110,x:499,y:256,color:"white"}),D=p({anchor:{x:.5,y:.5},width:14,height:14,x:256,y:320,color:"white"}),I=function(){return new F(...arguments)}({id:"main",objects:[p({width:512,height:512,x:0,y:0,color:"darkgray"}),L,q,D]}),R=m({update:function(){X("space")&&R.stop()},render:function(){}}),B=m({update:function(t){console.log("update"),X("space")&&(console.log("time "),D.dx=3.5,D.dy=3.5),l(L,D)&&(D.dx=-D.dx),l(q,D)&&(D.dx=-D.dx),D.y<=D.height/2&&(D.dy=-D.dy),D.y>=512-D.height/2&&(D.dy=-D.dy),D.x>=512-D.width/2&&(B.stop(),alert("right player lost"),window.location.reload),D.x<=D.width/2&&(B.stop(),alert("left player lost"),window.location.reload),X("w")&&(L.y-=O),X("s")&&(L.y+=O),X("i")&&(q.y-=O),X("k")&&(q.y+=O),L.y>512-L.height/2&&(L.y=512-L.height/2),L.y<L.height/2&&(L.y=L.height/2),q.y>512-q.height/2&&(q.y=512-q.height/2),q.y<q.height/2&&(q.y=q.height/2),I.update()},render:function(){I.render()}});B.start()})();
/**
 * @preserve
 * Kontra.js v9.0.0
 */